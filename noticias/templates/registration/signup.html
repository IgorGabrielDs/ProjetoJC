{% extends "base.html" %}
{% block title %}Cadastro — JC{% endblock %}

{% block content %}
<div class="auth-page">
  <div class="auth-back">
    <a href="{% url 'noticias:index' %}">← Voltar</a>
  </div>

  <div class="auth-card">
    <h1>Cadastre-se no Jornal do Commercio</h1>
    <p class="auth-subtitle">Experiência completa em uma conta só.</p>

    <!-- Mensagens globais (ex: sucesso/erro após envio) -->
    {% if messages %}
      <div class="messages">
        {% for m in messages %}
          <p class="message {{ m.tags }}">{{ m }}</p>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" class="auth-form" action="">
      {% csrf_token %}
      {% if next %}
        <input type="hidden" name="next" value="{{ next }}">
      {% endif %}

      <!-- ====== Nome ====== -->
      <div class="field has-tip {% if errors.nome %}has-error{% endif %}">
        <label for="id_nome">Nome completo</label>
        <input id="id_nome" name="nome" type="text" class="auth-input"
               placeholder="Informe o seu nome completo"
               value="{{ old.nome|default_if_none:'' }}"
               required autocomplete="name">
        {% if errors.nome %}
          <div class="helper">{{ errors.nome }}</div>
        {% endif %}
      </div>

      <!-- ====== E-mail ====== -->
      <div class="field has-tip {% if errors.email %}has-error{% endif %}">
        <label for="id_email">Endereço de e-mail</label>
        <input id="id_email" name="email" type="email" class="auth-input"
               placeholder="Ex: seuemail@provedor.com"
               value="{{ old.email|default_if_none:'' }}"
               required autocomplete="email">
        {% if errors.email %}
          <div class="helper">{{ errors.email }}</div>
        {% endif %}
      </div>

      <!-- ====== Data de nascimento ====== -->
      <div class="field has-tip">
        <label for="id_data_nascimento">Data de nascimento</label>
        <input id="id_data_nascimento" name="data_nascimento" type="date" class="auth-input"
               placeholder="dd/mm/aaaa"
               value="{{ old.data_nascimento|default_if_none:'' }}"
               autocomplete="bday">
      </div>

      <!-- ====== Senha 1 ====== -->
      <div class="field has-tip {% if errors.password1 %}has-error{% endif %}">
        <label for="id_password1">Crie uma senha</label>
        <input id="id_password1" name="password1" type="password" class="auth-input"
               placeholder="Informe sua senha"
               required minlength="8"
               autocomplete="new-password"
               aria-describedby="help_pass1">
        {% if errors.password1 %}
          <div class="helper" id="help_pass1">{{ errors.password1 }}</div>
        {% else %}
          <div class="helper" id="help_pass1">Mínimo de 8 caracteres.</div>
        {% endif %}
      </div>

      <!-- ====== Senha 2 ====== -->
      <div class="field has-tip {% if errors.password2 %}has-error{% endif %}">
        <label for="id_password2">Confirme sua senha</label>
        <input id="id_password2" name="password2" type="password" class="auth-input"
               placeholder="Repita sua senha"
               required autocomplete="new-password"
               aria-describedby="help_pass2">
        {% if errors.password2 %}
          <div class="helper" id="help_pass2">{{ errors.password2 }}</div>
        {% endif %}
      </div>

      <!-- ====== Termos ====== -->
      <div class="auth-terms {% if errors.terms %}has-error{% endif %}">
        <!-- fallback: garante que sempre exista 'terms' no POST -->
        <input type="hidden" name="terms" value="off">
        <input id="id_terms" type="checkbox" name="terms" value="on"
               {% if old.terms %}checked{% endif %} required>
        <label for="id_terms">Li e concordo com os Termos de Uso.</label>
      </div>
      {% if errors.terms %}
        <div class="helper">{{ errors.terms }}</div>
      {% endif %}

      <!-- ====== Botão ====== -->
      <button type="submit"
              class="auth-submit"
              onclick="this.disabled=true; this.form.submit();">
        Continuar
      </button>
    </form>
  </div>
</div>
{% endblock %}
